---
phase: 04-skills
plan: 03
type: execute
wave: 2
depends_on: ["04-01"]
files_modified:
  - src/cli/skills.ts
  - src/cli/index.ts
  - src/index.ts
autonomous: true

must_haves:
  truths:
    - "User can run klausbot skills to see/install curated skills"
    - "skill-creator auto-installed on first run"
    - "Installed skills appear in ~/.klausbot/skills/"
  artifacts:
    - path: "src/cli/skills.ts"
      provides: "Skills CLI subcommand"
      exports: ["runSkillsCLI", "ensureSkillCreator"]
    - path: "src/cli/index.ts"
      provides: "CLI dispatcher with skills subcommand"
  key_links:
    - from: "src/cli/skills.ts"
      to: "~/.klausbot/skills/skill-creator"
      via: "fetch + writeFileSync"
      pattern: "skill-creator"
---

<objective>
Create CLI subcommand `klausbot skills` for viewing and installing curated skills interactively, plus auto-install skill-creator as mandatory pre-installed skill.

Purpose: Users need a way to install skills without manual file copying. skill-creator is required for creating new skills.
Output: Working `klausbot skills` command with interactive picker.
</objective>

<execution_context>
@/home/soham/.claude/get-shit-done/workflows/execute-plan.md
@/home/soham/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/04-skills/04-CONTEXT.md
@.planning/phases/04-skills/04-RESEARCH.md
@src/cli/install.ts
@src/cli/index.ts
@src/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create skills CLI module</name>
  <files>src/cli/skills.ts</files>
  <action>
Create src/cli/skills.ts with:

1. **CURATED_SKILLS constant:**
   ```typescript
   const CURATED_SKILLS = [
     {
       name: 'skill-creator',
       description: 'Create new skills interactively (Anthropic official)',
       source: 'https://raw.githubusercontent.com/anthropics/skills/main/skills/skill-creator/SKILL.md',
       category: 'utilities' as const,
       mandatory: true,  // Auto-installed
     },
     {
       name: 'summarize',
       description: 'Condense text content into key points',
       source: 'https://raw.githubusercontent.com/anthropics/skills/main/skills/summarize/SKILL.md',
       category: 'information' as const,
       mandatory: false,
     },
   ] as const;
   ```

2. **ensureSkillCreator() async function:**
   - Check if `~/.klausbot/skills/skill-creator/SKILL.md` exists
   - If not, fetch from anthropics/skills GitHub repo
   - Create directory and write SKILL.md
   - Log installation
   - Called at gateway startup to ensure skill-creator always exists

3. **isSkillInstalled(name: string) function:**
   - Check if `~/.klausbot/skills/{name}/SKILL.md` exists

4. **installSkill(skill) async function:**
   - Fetch SKILL.md from source URL
   - Create `~/.klausbot/skills/{name}/` directory
   - Write SKILL.md
   - Log success

5. **runSkillsCLI() async function:**
   - Use @inquirer/prompts select (already in package.json)
   - Show menu:
     - "View installed skills" - list what's in ~/.klausbot/skills/
     - "Install curated skill" - show picker from CURATED_SKILLS
     - "Exit"
   - For installation: show only non-installed skills
   - After install, offer to install another or exit

Import from '../memory/home.js' for KLAUSBOT_HOME, getHomePath.
Use createChildLogger('cli:skills') for logging.
  </action>
  <verify>`npx tsc --noEmit` compiles; ensureSkillCreator and runSkillsCLI exported</verify>
  <done>Skills CLI module with interactive picker and skill-creator auto-install</done>
</task>

<task type="auto">
  <name>Task 2: Wire skills CLI to dispatcher</name>
  <files>src/cli/index.ts, src/index.ts</files>
  <action>
1. **Update src/cli/index.ts:**
   - Add 'skills' to exports:
   ```typescript
   export { runInstallWizard } from './install.js';
   export { runSkillsCLI, ensureSkillCreator } from './skills.js';
   ```

2. **Update src/index.ts main dispatcher:**
   - Add 'skills' command handling:
   ```typescript
   case 'skills':
     const { runSkillsCLI } = await import('./cli/index.js');
     await runSkillsCLI();
     break;
   ```

3. **Update help text** in src/index.ts to include:
   ```
   skills     - Manage installed skills
   ```
  </action>
  <verify>`npx tsc --noEmit`; `node dist/index.js skills` shows skills menu</verify>
  <done>klausbot skills command accessible from CLI</done>
</task>

<task type="auto">
  <name>Task 3: Auto-install skill-creator at gateway startup</name>
  <files>src/daemon/gateway.ts</files>
  <action>
In src/daemon/gateway.ts startGateway():

1. **Import ensureSkillCreator:**
   ```typescript
   import { ensureSkillCreator } from '../cli/skills.js';
   ```

2. **Call ensureSkillCreator() after initializeHome:**
   ```typescript
   // Ensure skill-creator is always available
   await ensureSkillCreator();
   ```

This guarantees skill-creator exists before skill discovery runs.
  </action>
  <verify>Gateway starts and skill-creator auto-installs if missing</verify>
  <done>skill-creator auto-installed on gateway startup</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` compiles without errors
2. `npm run build && node dist/index.js skills` opens interactive menu
3. "View installed skills" shows skill-creator (after first gateway run)
4. Install a curated skill, verify it appears in ~/.klausbot/skills/
5. Gateway startup logs skill-creator installation on first run
</verification>

<success_criteria>
- `klausbot skills` command shows interactive menu
- skill-creator auto-installed on gateway startup
- Users can install curated skills from menu
- Installed skills visible in ~/.klausbot/skills/
</success_criteria>

<output>
After completion, create `.planning/phases/04-skills/04-03-SUMMARY.md`
</output>
